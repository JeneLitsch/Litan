
struct Bar {
	var int x;
}

struct Foo {
	var Bar bar;
}

fnx main() voi {
	var int a;
	a = 42;
	->print(-a);
	->print(2.0 * -(3.0 - 1.0));
	->print(1 + 2 + 3);
	
	for(idx, 1, 10) {
		->print(idx);
	}
	
	repeat(3) {
		->print(4.2);
	}
	
	var int i;
	i = 0;
	while(i < 3) {
		if(i <= 0) {
			->print(0.5);
		}
		else if(i <= 1) {
			->print(1.5);
		}
		else if(i <= 2) {
			->print(2.5);
		}
		->print(i);
		i = i + 1;
	}
	
	->print(->toInt(42.6));
	->print(->toFlt(42) + 0.5);
	a = 43 - 1;
	->print(a);
	var Foo foo;
	var Bar bar;
	foo = ->makeFoo();
	foo.bar.x = 41;
	->print(foo.bar.x);
	asm {
		"size"
		"print"
	}
	var Foo foo2;
	foo = new Foo();
	return;
}

fnx makeFoo() Foo {
	var Foo foo; 
	var Bar bar;
	bar = ->makeBar();
	asm {
		"array::new" "store 0"
		"load 0" "load 1" "array::add"
	}
	return foo;
}

fnx makeBar() Bar {
	var Bar bar;
	asm {
		"array::new" "store 0"
		"load 0" "newl 42" "array::add"
	}
	return bar;
}

// fnx getX(Foo foo) int {
// 	asm {
// 		"load 0"
// 		"newl 0" "array::get"
// 	}
// 	asm {
// 		"newl 0" "array::get"
// 	}
// 	asm {
// 		"return"
// 	}
// }

// fnx setX(Foo foo, int x) voi {
// 	asm {
// 		"load 0"
// 		"newl 0" "array::get"
// 	}
// 	asm {
// 		"newl 0" "load 1" "array::set"
// 	}
// 	asm {
// 		"return"
// 	}
// }

// typedef Foo;

// struct Bar {
// 	var int a;
// 	var int b;
// 	var flt c;
// }

// fnx main() voi {
// 	var str str1;
// 	var str str2;
// 	var str str3;
// 	str1 = "hello ";
// 	str2 = "world!";
// 	str3 = ->add(str1, str2);
// 	-> print(str1);
// 	-> print(str2);
// 	-> print(str3);

// 	var str str4;
// 	str4 = "Lorem ipsum dolor sit amet";
// 	-> print(str4);

// 	->print(->min(3, 2));
// 	->print(->min(3.0, 2.0));
// 	->print(->max(3, 2));
// 	->print(->max(3.0, 2.0));

// 	-> delete(str1);
// 	-> delete(str2);
// 	-> delete(str3);
// 	-> delete(str4);

// 	var Foo a;
// 	a = -> makeFoo();
// 	-> print(a);

// 	var Bar b;
// 	b.a = 42;
// }

// fnx makeFoo() Foo {
// 	asm {
// 		"newl 42"
// 		"return"
// 	}
// }

// fnx print(Foo obj) voi {
// 	asm {
// 		"load 0"
// 		"print"
// 		"return"
// 	}
// }

// fnx hello() str {
// 	asm {
// 		"string::new"
// 		"string::data 'hello '"
// 		"return"
// 	}
// }

// fnx world() str {
// 	asm {
// 		"string::new"
// 		"string::data 'world'"
// 		"return"
// 	}
// }