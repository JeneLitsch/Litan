flags = [
	"-std=c++2a",
	"-O3",
	"-W",
	"-Wall",
	"-Wextra",
	"-pedantic",
	"-Wpedantic",
	"-pedantic-errors",
	"-Wunused",
	"-Wwrite-strings",
	"-Wconversion",
	"-Wunreachable-code",
	"-Wuninitialized",
	"-Wold-style-cast",
	"-Walloca",
	"-Wparentheses",
	"-Wno-unknown-pragmas"
]

def glob(dirs):
	files = []
	for dir in dirs:
		files.append(Glob(dir + "/*.cxx"))
	return files

incl = [
	".",
	"libs/stdxx",
]

env = Environment(
	CXX = "clang++-12",
	# CXX = "g++-10",
	CXXFLAGS = flags,
	CPPPATH = incl,
	CPPDEFINES = [],
	LIBS = [],
	LIBPATH = ".",
	SCONS_CXX_STANDART="c++20",
	CXXCOMSTR = "[Compiling] $TARGET",
	LINKCOMSTR = "[Linking] $TARGET")


ltnc = [
	"ltnc",
	"ltnc/print",
	"ltnc/compile",
	"ltnc/compile/build_in",
	"ltnc/compile/utils",
	"ltnc/peephole",
	"ltnc/ast",
	"ltnc/lex",
	"ltnc/parse",
	"ltnc/unfold",
	"ltnc/optimize",
	"ltnc/assemble",
	"ltnc/tokens",
]
ltncCli = [
	"ltnc/cli",
]


ltnvm = [
	"ltnvm",
	"ltnvm/build_in",
	"ltnvm/external",
	"ltnvm/inst",
	"ltnvm/memory",
	"ltnvm/memory/objects",
]
ltnvmCli = [
	"ltnvm/cli",
]

ltnCli = [
	"ltn/cli"
]

env.Program('bin/ltnc', glob(ltnc + ltncCli))
env.Program('bin/ltnvm', glob(ltnvm + ltnvmCli))
env.Program('bin/ltn', glob(ltnc + ltnvm + ltnCli))
