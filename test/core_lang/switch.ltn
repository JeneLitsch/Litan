namespace core {
	function switch_value(sphinx) {
		var fx_switch = lambda (x) {
			switch (x) {
				case "ABC":   return 1;
				case [1,2,3]: return 2;
				case 'A':     return 3;
				case 1:       return 1;
				case 2:       return 2;
				case 3:       return 3;
				case 1.5:     return 1 + x;
				case 2.5:     return 2 + x;
				case 3.5:     return 3 + x;
				default: return null;
			}
			return null;
		};

		var fx_choose = lambda (x) {
			return choose (x) {
				case "ABC":   1
				case [1,2,3]: 2
				case 'A':     3
				case 1: 1
				case 2: 2
				case 3: 3
				case 1.5: 1 + x
				case 2.5: 2 + x
				case 3.5: 3 + x
			};
		};

		var cases = [
			sphinx::assert_result([-1], null),
			sphinx::assert_result(["ABC"], 1),
			sphinx::assert_result([[1,2,3]], 2),
			sphinx::assert_result(['A'], 3),
			sphinx::assert_result([std::cout()], null),
			sphinx::assert_result([-1], null),
			sphinx::assert_result([1], 1),
			sphinx::assert_result([2], 2),
			sphinx::assert_result([3], 3),
			sphinx::assert_result([4], null),
			sphinx::assert_result([-1], null),
			sphinx::assert_result([1.5], 2.5),
			sphinx::assert_result([2.5], 4.5),
			sphinx::assert_result([3.5], 6.5),
			sphinx::assert_result([4], null),
		];

		sphinx::run_test(sphinx, "switch", fx_switch, cases);
		sphinx::run_test(sphinx, "choose", fx_choose, cases);
	}



	function switch_type(sphinx) {
		var x = "";
		var cases = [
			type_check(
				decltype(choose (x) {
					case "A": 1;
					case "B": 2;
					default: 3;}), 
				"int"
			),
			type_check(
				decltype(choose (x) {
					case "A": 1;
					case "B": 2;
				}), 
				"any"
			),
			type_check(
				decltype(choose (x) {}), 
				"null"
			),
		];

        sphinx::run_test(sphinx, "Operator & type",  lambda(x) => x, cases);
	}



	function switch_(sphinx) {
		switch_value(sphinx);
		switch_type(sphinx);
	}
}